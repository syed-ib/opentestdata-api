paths:
  NewDatum:
    post:
      summary: Create a new test datum
      operationId: api.handlers.data.create
      requestBody:
        $ref: '#/requests/DatumDetails'
      responses:
        '200':
          $ref: '#/responses/Datum'
        '500':
          $ref: 'base.yaml#/responses/Error'
      security:
        - jwt: []
  GetOrUpdateDatum:
    get:
      summary: Get details of a datum
      parameters:
        $ref: '#/parameters/DatumId'
      operationId: api.handlers.data.detail
      responses:
        '200':
          $ref: '#/responses/Datum'
        '500':
          $ref: 'base.yaml#/responses/Error'
      security:
        - jwt: []
    post:
      summary: Update a test datum
      operationId: api.handlers.data.update
      parameters:
        $ref: '#/parameters/DatumId'
      requestBody:
        $ref: '#/requests/DatumDetails'
      responses:
        '200':
          $ref: '#/responses/Datum'
        '500':
          $ref: 'base.yaml#/responses/Error'
      security:
        - jwt: []

parameters:
  DatumId:
    - in: path
      name: id
      required: true
      schema:
        type: integer
        minimum: 1
      description: The datum ID

requests:
  DatumDetails:
    description: Datum details
    required: true
    content:
      application/json:
        schema:
          $ref: '#/schemas/DatumBase'

responses:
  Datum:
    description: Datum details
    content:
      application/json:
        schema:
          $ref: '#/schemas/Datum'

schemas:
  DatumBase:
    properties:
      name:
        type: string
        maxLength: 100
        minLength: 1
      type:
        type: string
        enum:
          - 'NULL'
          - BOOL
          - NUM
          - STR
          - OBJ
      value:
        type: string
        maxLength: 1024
    required:
      - name
      - type
      - value
    additionalProperties: false 
  Datum:
    allOf:
      - $ref: '#/schemas/DatumBase'
      - $ref: 'base.yaml#/schemas/Base'
      - properties:
          user_id:
            type: integer
